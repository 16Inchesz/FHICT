
[plantuml, state-diagram, svg]
-----
skinparam handwritten true
skinparam defaultFontName "Ink Free"
skinparam defaultTextAlignment center

state "Traffic Licht Master" as TrafficLichtMaster {
    [*] --> RED : /\nTurnRedOn();\nResetTimer()
    'RED --> GREEN : HasTimerExpired(delay) && MessageAvailable() / \nmsg = ReadMessage()
    RED --> SLAVE_GREEN : HasTimerExpired(delay) /\nSendMessage("$GotoGreen;");\nResetTimer()
    SLAVE_GREEN --> SLAVE_GREEN_ACK : / result = UNDEFINED
    SLAVE_GREEN_ACK --> SLAVE_GREEN_ACK : result == UNDEFINED /\nresult = ReadAcknowledge(5s)
    SLAVE_GREEN_ACK --> SLAVE_GREEN : result == FAILED /\nSendMessage("$GotoGreen;");\nResetTimer()
    SLAVE_GREEN_ACK --> SLAVE_ORANGE : result == DONE && \nHasTimerExpired(delay) /\nSendMessage("$GotoOrange;");\nResetTimer()
    SLAVE_GREEN_ACK --> SLAVE_GREEN_UNKNOWN : result == UNKNOWN
    SLAVE_GREEN_ACK --> SLAVE_GREEN_CORRUPTED : result == CORRUPT
    SLAVE_GREEN_ACK --> SLAVE_GREEN_TIMEDOUT : result == TIMEDOUT
    SLAVE_ORANGE --> SLAVE_RED : HasTimerExpired(delay) /\nSendMessage("$GotoRed;");\nResetTimer()
    SLAVE_RED --> GREEN : HasTimerExpired(delay) /\nTurnRedOff();\nTurnGreenOn();\nResetTimer()
    GREEN --> ORANGE : HasTimerExpired(delay) /\nTurnGreenOff();\nTurnOrangeOn();\nResetTimer()
    ORANGE --> RED : HasTimerExpired(delay) /\nTurnOrangeOff();\nTurnRedOn();\nResetTimer()

    state SLAVE_GREEN #lightblue
    state SLAVE_ORANGE #lightblue
    state SLAVE_RED #lightblue
    state SLAVE_GREEN_ACK #lightgreen
    state SLAVE_GREEN_UNKNOWN #lightgreen
    state SLAVE_GREEN_CORRUPTED #lightgreen
    state SLAVE_GREEN_TIMEDOUT #lightgreen
}
-----

